<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL进阶 | viki</title>
    <meta name="generator" content="VuePress 1.9.2">
    <link rel="icon" href="/img/logo2.jpg">
    <meta name="description" content="viki`s blog">
    <meta name="keywords" content="vuepress,theme,blog,vdoing">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.c0a13355.css" as="style"><link rel="preload" href="/assets/js/app.9f1ace71.js" as="script"><link rel="preload" href="/assets/js/2.acae172f.js" as="script"><link rel="preload" href="/assets/js/3.71c56e22.js" as="script"><link rel="preload" href="/assets/js/5.70e5e3ae.js" as="script"><link rel="prefetch" href="/assets/js/10.ef41a5b1.js"><link rel="prefetch" href="/assets/js/11.c5e9df66.js"><link rel="prefetch" href="/assets/js/12.562d0b11.js"><link rel="prefetch" href="/assets/js/13.94b7f0ec.js"><link rel="prefetch" href="/assets/js/14.b308bbdc.js"><link rel="prefetch" href="/assets/js/15.cf843c7e.js"><link rel="prefetch" href="/assets/js/16.eccd0ad4.js"><link rel="prefetch" href="/assets/js/17.35053421.js"><link rel="prefetch" href="/assets/js/18.b88e13b3.js"><link rel="prefetch" href="/assets/js/19.59076647.js"><link rel="prefetch" href="/assets/js/20.ccd4e286.js"><link rel="prefetch" href="/assets/js/21.dd65ce2e.js"><link rel="prefetch" href="/assets/js/22.c21d9f43.js"><link rel="prefetch" href="/assets/js/23.e687f0f8.js"><link rel="prefetch" href="/assets/js/24.2edf3fee.js"><link rel="prefetch" href="/assets/js/25.d7d6d1b7.js"><link rel="prefetch" href="/assets/js/26.96d64e54.js"><link rel="prefetch" href="/assets/js/27.4369a1fd.js"><link rel="prefetch" href="/assets/js/28.6173ce2d.js"><link rel="prefetch" href="/assets/js/29.39e00150.js"><link rel="prefetch" href="/assets/js/30.aae0affa.js"><link rel="prefetch" href="/assets/js/31.0d6e99fe.js"><link rel="prefetch" href="/assets/js/32.ee97954c.js"><link rel="prefetch" href="/assets/js/33.b57f7d4e.js"><link rel="prefetch" href="/assets/js/34.d1a06cd8.js"><link rel="prefetch" href="/assets/js/35.f03191b7.js"><link rel="prefetch" href="/assets/js/36.acdab7e0.js"><link rel="prefetch" href="/assets/js/37.17181c7a.js"><link rel="prefetch" href="/assets/js/38.15c2be1c.js"><link rel="prefetch" href="/assets/js/39.0eb4c654.js"><link rel="prefetch" href="/assets/js/4.3e1c98e7.js"><link rel="prefetch" href="/assets/js/40.08695d3c.js"><link rel="prefetch" href="/assets/js/41.edee4acc.js"><link rel="prefetch" href="/assets/js/42.d4a6bc7c.js"><link rel="prefetch" href="/assets/js/43.92060097.js"><link rel="prefetch" href="/assets/js/44.8648b83f.js"><link rel="prefetch" href="/assets/js/45.3d313376.js"><link rel="prefetch" href="/assets/js/46.2b51c3e0.js"><link rel="prefetch" href="/assets/js/47.69ecfee9.js"><link rel="prefetch" href="/assets/js/48.23ea4519.js"><link rel="prefetch" href="/assets/js/49.cb9f1ef1.js"><link rel="prefetch" href="/assets/js/50.2b121fe3.js"><link rel="prefetch" href="/assets/js/51.2dfa2a49.js"><link rel="prefetch" href="/assets/js/52.92f1b878.js"><link rel="prefetch" href="/assets/js/53.9e9a9fb3.js"><link rel="prefetch" href="/assets/js/54.993eb48a.js"><link rel="prefetch" href="/assets/js/55.3afde6ef.js"><link rel="prefetch" href="/assets/js/56.c47fcc4f.js"><link rel="prefetch" href="/assets/js/57.d201f2d6.js"><link rel="prefetch" href="/assets/js/58.c7cab613.js"><link rel="prefetch" href="/assets/js/59.68012960.js"><link rel="prefetch" href="/assets/js/6.3240da3a.js"><link rel="prefetch" href="/assets/js/60.97a67ff7.js"><link rel="prefetch" href="/assets/js/61.0ae18e2f.js"><link rel="prefetch" href="/assets/js/62.2585e98e.js"><link rel="prefetch" href="/assets/js/63.0337fa3c.js"><link rel="prefetch" href="/assets/js/64.6cdb3af2.js"><link rel="prefetch" href="/assets/js/65.67a9e6c2.js"><link rel="prefetch" href="/assets/js/66.c4cf09c9.js"><link rel="prefetch" href="/assets/js/67.32b4df95.js"><link rel="prefetch" href="/assets/js/68.d6e4fac3.js"><link rel="prefetch" href="/assets/js/69.27a8cf28.js"><link rel="prefetch" href="/assets/js/7.7db7c6ce.js"><link rel="prefetch" href="/assets/js/70.56280f39.js"><link rel="prefetch" href="/assets/js/71.db0bef2a.js"><link rel="prefetch" href="/assets/js/72.ea0db57a.js"><link rel="prefetch" href="/assets/js/73.fe988115.js"><link rel="prefetch" href="/assets/js/74.3c725cc1.js"><link rel="prefetch" href="/assets/js/75.b2ea4d75.js"><link rel="prefetch" href="/assets/js/76.1da2c1a8.js"><link rel="prefetch" href="/assets/js/77.f5326468.js"><link rel="prefetch" href="/assets/js/78.ed3ceb1c.js"><link rel="prefetch" href="/assets/js/79.e510d25f.js"><link rel="prefetch" href="/assets/js/8.4b447818.js"><link rel="prefetch" href="/assets/js/80.46a50c1e.js"><link rel="prefetch" href="/assets/js/81.9aee972d.js"><link rel="prefetch" href="/assets/js/82.b97f0246.js"><link rel="prefetch" href="/assets/js/83.1f8976a4.js"><link rel="prefetch" href="/assets/js/9.aa59e582.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c0a13355.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo2.jpg" alt="viki" class="logo"> <span class="site-name can-hide">viki</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语法框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/69d591/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/862342/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/pages/0e295d/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/pages/dbd4b7/" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/pages/ec02d8/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/pages/1257a3/" class="nav-link">Element-UI</a></li><li class="dropdown-subitem"><a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue-CLI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>部署构建</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/862342/" class="nav-link">npm</a></li><li class="dropdown-subitem"><a href="/pages/e743fe/" class="nav-link">yarn</a></li><li class="dropdown-subitem"><a href="/pages/7038b1/" class="nav-link">webpack</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java集合</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java线程</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">JUC</a></li><li class="dropdown-item"><!----> <a href="/pages/e4d55d/" class="nav-link">Java8新特性</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java11新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Go" class="dropdown-title"><!----> <span class="title" style="display:;">Go</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://go.dev/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Go docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.topgoer.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Go Easystart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dokcer docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://kubernetes.io/zh/docs/home/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kubernetes docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/659d0f/" aria-current="page" class="nav-link router-link-exact-active router-link-active">MySQL</a></li><li class="dropdown-item"><!----> <a href="/pages/7e8569/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/7c9b4b/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">查找算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring&amp;框架" class="dropdown-title"><!----> <span class="title" style="display:;">Spring&amp;框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring系列</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a832bb/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/pages/35de30/" class="nav-link">Spring MVC</a></li><li class="dropdown-subitem"><a href="/pages/d803de/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/pages/d803de/" class="nav-link">Spring Native</a></li></ul></li><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/" class="nav-link">Spring GateWay</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Eureka</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Nacos</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Feign</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Hystrix</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Sentinel</a></li></ul></li><li class="dropdown-item"><h4>ORM框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5c205b/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/pages/4e88d5/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>常用框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/pages/ec2247/" class="nav-link">EasyExcel</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>构建部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/4a375c/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/pages/374a76/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/pages/711d35/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/pages/118379/" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Nginx</a></li></ul></li><li class="dropdown-item"><h4>开发调试</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/d1300e/" class="nav-link">IDEA</a></li><li class="dropdown-subitem"><a href="/pages/5451e7/" class="nav-link">VScode</a></li><li class="dropdown-subitem"><a href="/pages/155967/" class="nav-link">Swagger2</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Apifox</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Postman</a></li></ul></li><li class="dropdown-item"><h4>网络&amp;其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/78eaba/" class="nav-link">计算机网络</a></li><li class="dropdown-subitem"><a href="/pages/c027ac/" class="nav-link">设计模式</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link">设计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><!----> <span class="title" style="display:;">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/46344d/" class="nav-link">好用利器</a></li><li class="dropdown-item"><!----> <a href="/pages/2c260b/" class="nav-link">细读文章</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">看一本书</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">日常发呆</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">联系我</a></li></ul></div></div> <a href="https://github.com/vikicoco" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>语法框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/69d591/" class="nav-link">HTML</a></li><li class="dropdown-subitem"><a href="/pages/862342/" class="nav-link">CSS</a></li><li class="dropdown-subitem"><a href="/pages/0e295d/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/pages/dbd4b7/" class="nav-link">ES6</a></li><li class="dropdown-subitem"><a href="/pages/ec02d8/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/pages/1257a3/" class="nav-link">Element-UI</a></li><li class="dropdown-subitem"><a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue-CLI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>部署构建</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/862342/" class="nav-link">npm</a></li><li class="dropdown-subitem"><a href="/pages/e743fe/" class="nav-link">yarn</a></li><li class="dropdown-subitem"><a href="/pages/7038b1/" class="nav-link">webpack</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java基础</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java集合</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java线程</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">JUC</a></li><li class="dropdown-item"><!----> <a href="/pages/e4d55d/" class="nav-link">Java8新特性</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">Java11新特性</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Go" class="dropdown-title"><!----> <span class="title" style="display:;">Go</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://go.dev/doc/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Go docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.topgoer.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Go Easystart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dokcer docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://kubernetes.io/zh/docs/home/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  kubernetes docs
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/659d0f/" aria-current="page" class="nav-link router-link-exact-active router-link-active">MySQL</a></li><li class="dropdown-item"><!----> <a href="/pages/7e8569/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/7c9b4b/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">ElasticSearch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><!----> <span class="title" style="display:;">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">数据结构</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">排序算法</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">查找算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring&amp;框架" class="dropdown-title"><!----> <span class="title" style="display:;">Spring&amp;框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Spring系列</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/a832bb/" class="nav-link">Spring</a></li><li class="dropdown-subitem"><a href="/pages/35de30/" class="nav-link">Spring MVC</a></li><li class="dropdown-subitem"><a href="/pages/d803de/" class="nav-link">Spring Boot</a></li><li class="dropdown-subitem"><a href="/pages/d803de/" class="nav-link">Spring Native</a></li></ul></li><li class="dropdown-item"><h4>Spring Cloud</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/" class="nav-link">Spring GateWay</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Eureka</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Nacos</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Feign</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Hystrix</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Spring Sentinel</a></li></ul></li><li class="dropdown-item"><h4>ORM框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/5c205b/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/pages/4e88d5/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>常用框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/pages/ec2247/" class="nav-link">EasyExcel</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><!----> <span class="title" style="display:;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>构建部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/4a375c/" class="nav-link">Git</a></li><li class="dropdown-subitem"><a href="/pages/374a76/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/pages/711d35/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/pages/118379/" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Nginx</a></li></ul></li><li class="dropdown-item"><h4>开发调试</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/d1300e/" class="nav-link">IDEA</a></li><li class="dropdown-subitem"><a href="/pages/5451e7/" class="nav-link">VScode</a></li><li class="dropdown-subitem"><a href="/pages/155967/" class="nav-link">Swagger2</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Apifox</a></li><li class="dropdown-subitem"><a href="/" class="nav-link">Postman</a></li></ul></li><li class="dropdown-item"><h4>网络&amp;其他</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/78eaba/" class="nav-link">计算机网络</a></li><li class="dropdown-subitem"><a href="/pages/c027ac/" class="nav-link">设计模式</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/" class="nav-link">设计</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><!----> <span class="title" style="display:;">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/46344d/" class="nav-link">好用利器</a></li><li class="dropdown-item"><!----> <a href="/pages/2c260b/" class="nav-link">细读文章</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">看一本书</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">日常发呆</a></li><li class="dropdown-item"><!----> <a href="/" class="nav-link">联系我</a></li></ul></div></div> <a href="https://github.com/vikicoco" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MySQL</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/fd06c0/" class="sidebar-link">MySQL基础</a></li><li><a href="/pages/659d0f/" aria-current="page" class="active sidebar-link">MySQL进阶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/659d0f/#安装使用" class="sidebar-link">安装使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/659d0f/#_1-清理环境" class="sidebar-link">1.清理环境</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_2-安装-初始化" class="sidebar-link">2.安装+初始化</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_3-自启动-临时密码" class="sidebar-link">3.自启动+临时密码</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_4-字符集问题" class="sidebar-link">4.字符集问题</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_5-目录结构" class="sidebar-link">5.目录结构</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#用户权限" class="sidebar-link">用户权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/659d0f/#_1-查看权限表" class="sidebar-link">1.查看权限表</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_2-创建用户" class="sidebar-link">2.创建用户</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_3-修改密码" class="sidebar-link">3.修改密码</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_4-修改用户名" class="sidebar-link">4.修改用户名</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_5-删除用户" class="sidebar-link">5.删除用户</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_6-分配权限" class="sidebar-link">6.分配权限</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_7-撤销权限" class="sidebar-link">7.撤销权限</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_8-查看权限" class="sidebar-link">8.查看权限</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#存储引擎" class="sidebar-link">存储引擎</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/659d0f/#_1-mysql架构图" class="sidebar-link">1.MySQL架构图</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_2-开启mysql缓存" class="sidebar-link">2.开启MySQL缓存</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_3-缓存小栗子" class="sidebar-link">3.缓存小栗子</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_4-innodb" class="sidebar-link">4.InnoDB</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_5-myisam" class="sidebar-link">5.MyISAM</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_6-其他存储引擎" class="sidebar-link">6.其他存储引擎</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#sql执行顺序" class="sidebar-link">SQL执行顺序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/659d0f/#_1-完整sql执行流程" class="sidebar-link">1.完整sql执行流程</a></li><li class="sidebar-sub-header"><a href="/pages/659d0f/#_2-再探join" class="sidebar-link">2.再探join</a></li></ul></li></ul></li><li><a href="/pages/454bc7/" class="sidebar-link">索引失效</a></li><li><a href="/pages/2b5d14/" class="sidebar-link">数据库设计规范</a></li><li><a href="/pages/79ebd4/" class="sidebar-link">MySQL事务</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MongoDB</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-2d79ef86><div class="articleInfo" data-v-2d79ef86><ul class="breadcrumbs" data-v-2d79ef86><li data-v-2d79ef86><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-2d79ef86></a></li> <li data-v-2d79ef86><a href="/categories/?category=%E6%95%B0%E6%8D%AE%E5%BA%93" title="分类" data-v-2d79ef86>数据库</a></li><li data-v-2d79ef86><a href="/categories/?category=MySQL" title="分类" data-v-2d79ef86>MySQL</a></li></ul> <div class="info" data-v-2d79ef86><div title="作者" class="author iconfont icon-touxiang" data-v-2d79ef86><a href="javascript:;" data-v-2d79ef86>viki</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-2d79ef86><a href="javascript:;" data-v-2d79ef86>2022-01-15</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="/img/artical64.png">MySQL进阶<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="mysql常用总结"><a href="#mysql常用总结" class="header-anchor">#</a> MySQL常用总结</h1> <h2 id="安装使用"><a href="#安装使用" class="header-anchor">#</a> 安装使用</h2> <h3 id="_1-清理环境"><a href="#_1-清理环境" class="header-anchor">#</a> 1.清理环境</h3> <p><strong>卸载MariaDB</strong></p> <blockquote><p>因为一些Linux上会自带MariaDB，它是MySQL的二次开发版本</p> <p>MariaDB的存储引擎使用XtraDB</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#是否存在MariaDB</span>
<span class="token function">rpm</span> -qa<span class="token operator">|</span><span class="token function">grep</span> mariadb

<span class="token comment">#卸载MariaDB</span>
<span class="token function">rpm</span> -e --nodeps mariadb-libs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>卸载MySQL5.5</strong></p> <blockquote><p>若以前安装过MySQL5.5</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#查看要卸载的MySQL名称 -i表示不区分大小写</span>
<span class="token function">rpm</span> -qa<span class="token operator">|</span><span class="token function">grep</span> -i mysql

<span class="token comment">#关闭MySQL服务</span>
<span class="token function">service</span> msyql stop

<span class="token comment">#卸载客户端</span>
<span class="token function">rpm</span> -e MySQL-client-5.5.54-1.linux2.6.x86_64

<span class="token comment">#卸载服务端</span>
<span class="token function">rpm</span> -e MySQL-server-5.5.54-1.linux2.6.x86_64

<span class="token comment">#查看是否有卸载残留</span>
<span class="token function">whereis</span> mysql 

<span class="token comment">#删除卸载残留 尤其其中/var/lib/mysql一定要确保删除</span>
<span class="token function">find</span> / -iname <span class="token string">'mysql'</span>

<span class="token comment">#删除/etc/my.cnf文件</span>
<span class="token function">rm</span> /etc/my.cnf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>卸载MySQL5.7</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#关闭服务</span>
systemctl stop mysqld

<span class="token comment">#和安装相反的顺序删除rpm</span>
<span class="token function">rpm</span> -e mysql-community-server-5.7.28-1.el7.x86_64
<span class="token function">rpm</span> -e mysql-community-client-5.7.28-1.el7.x86_64
<span class="token function">rpm</span> -e mysql-community-libs-5.7.28-1.el7.x86_64
<span class="token function">rpm</span> -e mysql-community-common-5.7.28-1.el7.x86_64

<span class="token comment">#查看是否有卸载残留</span>
<span class="token function">whereis</span> mysql
<span class="token function">rm</span> -rvf xxx

<span class="token comment">#删除/etc/my.cnf</span>
<span class="token function">rm</span> /etc/my.cnf

<span class="token comment">#查询是否还有什么残留信息  尤其其中/var/lib/mysql一定要确保删除</span>
<span class="token function">find</span> / -iname mysql
<span class="token function">rm</span> -rvf xxx

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_2-安装-初始化"><a href="#_2-安装-初始化" class="header-anchor">#</a> 2.安装+初始化</h3> <p><strong>MySQL下载</strong></p> <p>MySQL官网 https://www.mysql.com</p> <p>下载所需要的包</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rpm -ivh mysql-community-common-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-libs-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-client-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-server-5.7.28-1.el7.x86_64.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>MySQL Linux中安装</strong></p> <p>拷贝包到/opt目录下</p> <p>执行rpm安装命令</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>rpm -ivh mysql-community-common-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-libs-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-client-5.7.28-1.el7.x86_64.rpm

rpm -ivh mysql-community-server-5.7.28-1.el7.x86_64.rpm
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>查看是否安装成功</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#查看MySQL版本</span>
mysqladmin --version

<span class="token comment">#查看软件包是否安装成功</span>
<span class="token function">rpm</span> -qa<span class="token operator">|</span><span class="token function">grep</span> mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>初始化MySQL</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#root身份运行，初始化MySQL生成临时密码</span>
mysqld --initialize --user<span class="token operator">=</span>mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>--initialize 选项默认以“安全”模式来初始化，会为 root 用户生成一个密码并将该密码标记为过期，登录后你要设置一个新的密码</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#查看生成的临时密码</span>
<span class="token function">cat</span> /var/log/mysqld.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>root@localhost: 后面就是初始化的密码</p></blockquote> <h3 id="_3-自启动-临时密码"><a href="#_3-自启动-临时密码" class="header-anchor">#</a> 3.自启动+临时密码</h3> <p><strong>MySQL服务管理命令</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#查看状态</span>
systemctl status mysqld.service

<span class="token comment">#启动</span>
systemctl start mysqld.service

<span class="token comment">#关闭</span>
systemctl stop mysqld.service

<span class="token comment">#重启</span>
systemctl restart mysqld.service

<span class="token comment">#是否自启动查询</span>
systemctl list-unit-files<span class="token operator">|</span><span class="token function">grep</span> mysqld.service

<span class="token comment">#开启自启动</span>
systemctl <span class="token builtin class-name">enable</span> mysqld.service

<span class="token comment">#关闭自启动</span>
systemctl disable mysqld.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>登录MySQL修改临时密码</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#登录MySQL,输入临时密码</span>
mysql <span class="token operator">-</span>uroot <span class="token operator">-</span>p

<span class="token comment">#修改临时密码</span>
<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'new_password'</span><span class="token punctuation">;</span>

<span class="token keyword">ALTER</span> <span class="token keyword">USER</span> <span class="token string">'root'</span><span class="token variable">@'localhost'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>

<span class="token comment">#quit退出，使用新密码登录即可</span>
quit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_4-字符集问题"><a href="#_4-字符集问题" class="header-anchor">#</a> 4.字符集问题</h3> <p><strong>查看字符集</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'character%'</span><span class="token punctuation">;</span> 

<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%char%'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>修改字符集</strong></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#编辑配置文件</span>
<span class="token function">vim</span> /etc/my.cnf

<span class="token comment">#添加默认字符集设置</span>
<span class="token punctuation">[</span>client<span class="token punctuation">]</span>
default-character-set<span class="token operator">=</span>utf8 <span class="token comment"># 客户端字符集</span>
<span class="token punctuation">[</span>mysqld<span class="token punctuation">]</span>
character-set-server<span class="token operator">=</span>utf8 <span class="token comment"># 必选 服务器端字符集</span>
collation-server<span class="token operator">=</span>utf8_general_ci <span class="token comment"># 服务器端校对规则</span>

<span class="token comment">#重启MySQL</span>
systemctl restart mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>修改以前库的字符集</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">database</span> mydb <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>修改以前表的字符集</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> dept <span class="token keyword">convert</span> <span class="token keyword">to</span> <span class="token keyword">character</span> <span class="token keyword">set</span> <span class="token string">'utf8'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>但是原有的数据如果是用非'utf8'编码的话，数据本身编码不会发生改变。</p> <p>已有数据需要导出或删除，然后重新插入。</p></blockquote> <h3 id="_5-目录结构"><a href="#_5-目录结构" class="header-anchor">#</a> 5.目录结构</h3> <table><thead><tr><th>参数</th> <th>路径</th> <th>解释</th> <th>备注</th></tr></thead> <tbody><tr><td>--basedir</td> <td>/usr/bin</td> <td>相关命令目录</td> <td>mysqladmin mysqldump等命令</td></tr> <tr><td>--datadir</td> <td>/var/lib/mysql/</td> <td>mysql数据库文件的存放路径</td> <td></td></tr> <tr><td>--plugin-dir</td> <td>/usr/lib64/mysql/plugin</td> <td>mysql插件存放路径</td> <td></td></tr> <tr><td>--log-error</td> <td>/var/log/mysqld.log</td> <td>mysql错误日志路径</td> <td></td></tr> <tr><td>--pid-file</td> <td><strong>/var/run/mysqld/mysqld.pid</strong></td> <td>进程pid文件</td> <td></td></tr> <tr><td>--socket</td> <td>/var/lib/mysql/mysql.sock</td> <td>本地连接时用的unix套接字文   件</td> <td></td></tr> <tr><td></td> <td>/usr/share/mysql</td> <td>配置文件目录</td> <td>mysql脚本及配置文件</td></tr> <tr><td></td> <td>/etc/systemd/system/multi-user.target.wants/mysqld.service</td> <td>服务启停相关脚本</td> <td></td></tr> <tr><td></td> <td>/etc/my.cnf</td> <td>mysql配置文件</td> <td>cat /etc/my.cnf</td></tr></tbody></table> <h2 id="用户权限"><a href="#用户权限" class="header-anchor">#</a> 用户权限</h2> <blockquote><p>MySQL的权限管理通过四张表实现 user,db,tables_priv,columns_priv</p></blockquote> <blockquote><p>全局权限表user,实现root的权限设置</p> <p>库级权限表db,实现当个库的权限设置</p> <p>表级权限表tables_priv，实现单张表的权限设置</p> <p>列级权限表columns_priv，实现单个字段的权限设置</p></blockquote> <p>当MySQL用户通过身份认证后，进行权限分配，分别按照user表，db表，tables_pirv表，columns_priv表的顺序验证加载权限</p> <blockquote><p>如果查询权限为N，则继续往下查询，查询都为Y，则停止查询，否则查到最后column_priv表</p></blockquote> <h3 id="_1-查看权限表"><a href="#_1-查看权限表" class="header-anchor">#</a> 1.查看权限表</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">use</span> mysql<span class="token punctuation">;</span>

<span class="token comment">#查看user表结构</span>
<span class="token keyword">desc</span> <span class="token keyword">user</span><span class="token punctuation">;</span>

<span class="token comment">#查看用户权限信息</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">user</span> \G<span class="token punctuation">;</span>

<span class="token keyword">select</span> <span class="token keyword">user</span><span class="token punctuation">,</span>host<span class="token punctuation">,</span>authentication_string<span class="token punctuation">,</span>plugin <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_2-创建用户"><a href="#_2-创建用户" class="header-anchor">#</a> 2.创建用户</h3> <blockquote><p>username：你将创建的用户名</p> <p>host：指定登录主机，不指定，默认为'%'</p> <ul><li>% --表示所有远程通过TCP方式连接</li> <li>IP --地址 如 (192.168.1.2,127.0.0.1) 通过制定ip地址进行的TCP方式的连接</li> <li>机器名 --通过制定网络中的机器名进行的TCP方式的连接</li> <li>::1 --IPv6的本地ip地址，等同于IPv4的 127.0.0.1</li> <li>localhost --本地方式通过命令行方式连接 ，如mysql -u xxx -p xxx 方式的连接。</li></ul></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#用户创建命令</span>
<span class="token comment"># --&gt; CREATE USER 'username'@'host' IDENTIFIED BY 'password';</span>

<span class="token keyword">create</span> <span class="token keyword">user</span> viki1<span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>

<span class="token comment">#查看user表</span>
<span class="token keyword">select</span> host<span class="token punctuation">,</span><span class="token keyword">user</span><span class="token punctuation">,</span>authentication_string<span class="token punctuation">,</span>plugin <span class="token keyword">from</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><img src="/assets/img/image-20220103231646572.e75e48cc.png" alt="image-20220103231646572"></p> <blockquote><p>注意：密码相同，使用mysql_native_password插件加密后密文相同,加密算法为MYSQLSHA1</p> <p>MySQL5.7密码保存在 authentication_string 字段中</p></blockquote> <h3 id="_3-修改密码"><a href="#_3-修改密码" class="header-anchor">#</a> 3.修改密码</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#修改当前用户密码</span>
<span class="token keyword">set</span> password <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'111111'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">#修改指定用户密码</span>
<span class="token keyword">update</span> msyql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">set</span> authentication_string <span class="token operator">=</span> password<span class="token punctuation">(</span><span class="token string">'666666'</span><span class="token punctuation">)</span> <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'viki1'</span><span class="token punctuation">;</span>

<span class="token comment">#刷新权限</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_4-修改用户名"><a href="#_4-修改用户名" class="header-anchor">#</a> 4.修改用户名</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#修改指定用户名，单表操作</span>
<span class="token keyword">update</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">set</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'kimi2'</span> <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'viki1'</span><span class="token punctuation">;</span>

<span class="token comment">#刷新权限</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_5-删除用户"><a href="#_5-删除用户" class="header-anchor">#</a> 5.删除用户</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#删除用户用drop</span>
<span class="token keyword">drop</span> <span class="token keyword">user</span> kimi<span class="token variable">@'localhost'</span>
<span class="token comment">#如果登录方式为%，可以省略不写</span>
<span class="token keyword">drop</span> <span class="token keyword">user</span> viki1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>不能通过delete from user u where user='li4' 进行删除，系统会有残留信息保留。</p></blockquote> <h3 id="_6-分配权限"><a href="#_6-分配权限" class="header-anchor">#</a> 6.分配权限</h3> <p><strong>使用grant命令分配指定权限，用户如果不存在则创建</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#给viki1分配testdb这个库下的所有表的CRUD权限(用户名@主机名)</span>
<span class="token keyword">grant</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">delete</span><span class="token punctuation">,</span><span class="token keyword">update</span> <span class="token keyword">on</span> testdb<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> viki1<span class="token variable">@'%'</span><span class="token punctuation">;</span>

<span class="token comment">#给Viki1分配可以给别人设置权限,后加（with grant option）</span>
<span class="token keyword">grant</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">delete</span><span class="token punctuation">,</span><span class="token keyword">update</span> <span class="token keyword">on</span> testdb<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> viki1<span class="token variable">@'%'</span> <span class="token keyword">with</span> <span class="token keyword">grant</span> <span class="token keyword">option</span><span class="token punctuation">;</span>

<span class="token comment">#刷新一下</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>

<span class="token comment">#查看刚刚给viki1分配的权限,查看db表是因为分配的是testdb库</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> db <span class="token keyword">where</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'viki1'</span> \G<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="/assets/img/image-20220104173949522.26126d04.png" alt="image-20220104173949522"></p> <p><strong>使用grant命令分配所有库表权限</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#创建一个用户并分配所有库表的权限</span>
<span class="token keyword">grant</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">to</span> coco<span class="token variable">@'localhost'</span> identified <span class="token keyword">by</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_7-撤销权限"><a href="#_7-撤销权限" class="header-anchor">#</a> 7.撤销权限</h3> <p><strong>使用revoke撤销权限</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># revoke 权限1,权限2,…权限n on 数据库名称.表名称 from 用户名@用户地址 ;</span>

<span class="token comment">#撤销所有库表的权限</span>
<span class="token keyword">revoke</span> <span class="token keyword">all</span> <span class="token keyword">privileges</span> <span class="token keyword">on</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> coco<span class="token variable">@'localhost'</span><span class="token punctuation">;</span>

<span class="token comment">#撤销对应库下的所有表的CRUD权限</span>
<span class="token keyword">revoke</span> <span class="token keyword">select</span><span class="token punctuation">,</span><span class="token keyword">insert</span><span class="token punctuation">,</span><span class="token keyword">update</span><span class="token punctuation">,</span><span class="token keyword">delete</span> <span class="token keyword">on</span> testdb<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">from</span> viki1<span class="token variable">@'%'</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_8-查看权限"><a href="#_8-查看权限" class="header-anchor">#</a> 8.查看权限</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#查看当前用户权限</span>
<span class="token keyword">show</span> grants<span class="token punctuation">;</span>

<span class="token comment">#查看某个用户的全局权限</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span> <span class="token keyword">where</span> <span class="token keyword">user</span> <span class="token operator">=</span> <span class="token string">'viki1'</span> \G<span class="token punctuation">;</span>

<span class="token comment">#查看某个用户某个表的权限</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span>tables_priv <span class="token keyword">where</span> <span class="token operator">=</span> <span class="token string">'coco'</span> <span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="存储引擎"><a href="#存储引擎" class="header-anchor">#</a> 存储引擎</h2> <h3 id="_1-mysql架构图"><a href="#_1-mysql架构图" class="header-anchor">#</a> 1.MySQL架构图</h3> <p><img src="/assets/img/image-20220106165104809.9b556bbc.png" alt="image-20220106165104809"></p> <h3 id="_2-开启mysql缓存"><a href="#_2-开启mysql缓存" class="header-anchor">#</a> 2.开启MySQL缓存</h3> <p><strong>修改/etc/my.cnf配置文件</strong></p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#新增一行
query_cache_tpye = 1

#重启MySQL服务
systemctl restart mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>再开启查询执行计划</strong></p> <blockquote><p>可以查询SQL语句底层的执行过程</p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#查看缓存是否成功开启</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%cache%'</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token operator">|</span> Variable_name                  <span class="token operator">|</span> <span class="token keyword">Value</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token operator">|</span> binlog_cache_size              <span class="token operator">|</span> <span class="token number">32768</span>                <span class="token operator">|</span>
<span class="token operator">|</span> binlog_stmt_cache_size         <span class="token operator">|</span> <span class="token number">32768</span>                <span class="token operator">|</span>
<span class="token operator">|</span> have_query_cache               <span class="token operator">|</span> YES                  <span class="token operator">|</span>
<span class="token operator">|</span> host_cache_size                <span class="token operator">|</span> <span class="token number">279</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> innodb_disable_sort_file_cache <span class="token operator">|</span> <span class="token keyword">OFF</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_cache_size           <span class="token operator">|</span> <span class="token number">8000000</span>              <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_result_cache_limit   <span class="token operator">|</span> <span class="token number">2000000000</span>           <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_total_cache_size     <span class="token operator">|</span> <span class="token number">640000000</span>            <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_age_threshold        <span class="token operator">|</span> <span class="token number">300</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_block_size           <span class="token operator">|</span> <span class="token number">1024</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_division_limit       <span class="token operator">|</span> <span class="token number">100</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> max_binlog_cache_size          <span class="token operator">|</span> <span class="token number">18446744073709547520</span> <span class="token operator">|</span>
<span class="token operator">|</span> max_binlog_stmt_cache_size     <span class="token operator">|</span> <span class="token number">18446744073709547520</span> <span class="token operator">|</span>
<span class="token operator">|</span> metadata_locks_cache_size      <span class="token operator">|</span> <span class="token number">1024</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_limit              <span class="token operator">|</span> <span class="token number">1048576</span>              <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_min_res_unit       <span class="token operator">|</span> <span class="token number">4096</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_size               <span class="token operator">|</span> <span class="token number">1048576</span>              <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_type               <span class="token operator">|</span> <span class="token keyword">OFF</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_wlock_invalidate   <span class="token operator">|</span> <span class="token keyword">OFF</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> stored_program_cache           <span class="token operator">|</span> <span class="token number">256</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> table_definition_cache         <span class="token operator">|</span> <span class="token number">1400</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> table_open_cache               <span class="token operator">|</span> <span class="token number">2000</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> table_open_cache_instances     <span class="token operator">|</span> <span class="token number">16</span>                   <span class="token operator">|</span>
<span class="token operator">|</span> thread_cache_size              <span class="token operator">|</span> <span class="token number">9</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token number">24</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>

<span class="token comment">#query_cache_tpye 为ON时缓存开启成功</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token operator">|</span> Variable_name                  <span class="token operator">|</span> <span class="token keyword">Value</span>                <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token operator">|</span> binlog_cache_size              <span class="token operator">|</span> <span class="token number">32768</span>                <span class="token operator">|</span>
<span class="token operator">|</span> binlog_stmt_cache_size         <span class="token operator">|</span> <span class="token number">32768</span>                <span class="token operator">|</span>
<span class="token operator">|</span> have_query_cache               <span class="token operator">|</span> YES                  <span class="token operator">|</span>
<span class="token operator">|</span> host_cache_size                <span class="token operator">|</span> <span class="token number">279</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> innodb_disable_sort_file_cache <span class="token operator">|</span> <span class="token keyword">OFF</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_cache_size           <span class="token operator">|</span> <span class="token number">8000000</span>              <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_result_cache_limit   <span class="token operator">|</span> <span class="token number">2000000000</span>           <span class="token operator">|</span>
<span class="token operator">|</span> innodb_ft_total_cache_size     <span class="token operator">|</span> <span class="token number">640000000</span>            <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_age_threshold        <span class="token operator">|</span> <span class="token number">300</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_block_size           <span class="token operator">|</span> <span class="token number">1024</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> key_cache_division_limit       <span class="token operator">|</span> <span class="token number">100</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> max_binlog_cache_size          <span class="token operator">|</span> <span class="token number">18446744073709547520</span> <span class="token operator">|</span>
<span class="token operator">|</span> max_binlog_stmt_cache_size     <span class="token operator">|</span> <span class="token number">18446744073709547520</span> <span class="token operator">|</span>
<span class="token operator">|</span> metadata_locks_cache_size      <span class="token operator">|</span> <span class="token number">1024</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_limit              <span class="token operator">|</span> <span class="token number">1048576</span>              <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_min_res_unit       <span class="token operator">|</span> <span class="token number">4096</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_size               <span class="token operator">|</span> <span class="token number">1048576</span>              <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_type               <span class="token operator">|</span> <span class="token keyword">ON</span>                   <span class="token operator">|</span>
<span class="token operator">|</span> query_cache_wlock_invalidate   <span class="token operator">|</span> <span class="token keyword">OFF</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> stored_program_cache           <span class="token operator">|</span> <span class="token number">256</span>                  <span class="token operator">|</span>
<span class="token operator">|</span> table_definition_cache         <span class="token operator">|</span> <span class="token number">1400</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> table_open_cache               <span class="token operator">|</span> <span class="token number">2000</span>                 <span class="token operator">|</span>
<span class="token operator">|</span> table_open_cache_instances     <span class="token operator">|</span> <span class="token number">16</span>                   <span class="token operator">|</span>
<span class="token operator">|</span> thread_cache_size              <span class="token operator">|</span> <span class="token number">9</span>                    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------------------+</span>
<span class="token number">24</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.04</span> sec<span class="token punctuation">)</span>

<span class="token comment">#查看查询计划是否开启，0关闭，1开启</span>
<span class="token keyword">select</span> @<span class="token variable">@profiling</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span> @<span class="token variable">@profiling</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token operator">|</span>           <span class="token number">0</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">-------------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">,</span> <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>


<span class="token comment">#等价于select @@profiling</span>
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%profiling%'</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">------------------------+-------+</span>
<span class="token operator">|</span> Variable_name          <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------+-------+</span>
<span class="token operator">|</span> have_profiling         <span class="token operator">|</span> YES   <span class="token operator">|</span>
<span class="token operator">|</span> profiling              <span class="token operator">|</span> <span class="token keyword">OFF</span>   <span class="token operator">|</span>
<span class="token operator">|</span> profiling_history_size <span class="token operator">|</span> <span class="token number">15</span>    <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">------------------------+-------+</span>
<span class="token number">3</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.05</span> sec<span class="token punctuation">)</span>

<span class="token comment">#要想看到查询过程，需要开启查询计划</span>
<span class="token keyword">set</span> profiling <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br></div></div><h3 id="_3-缓存小栗子"><a href="#_3-缓存小栗子" class="header-anchor">#</a> 3.缓存小栗子</h3> <p>执行同一条sql语句多次，查看执行过程</p> <p>执行相同sql，关键字大小写不同，不会命中缓存</p> <blockquote><p><strong>注意：SQL必须是一致的，否则，不能命中缓存。</strong></p></blockquote> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#执行任意一条sql</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>

<span class="token comment">#再重复执行一次</span>
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">#查看最近执行语句</span>
<span class="token keyword">show</span> profiles<span class="token punctuation">;</span>
mysql<span class="token operator">&gt;</span> <span class="token keyword">show</span> profiles<span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">----------+------------+---------------------------------------------------------+</span>
<span class="token operator">|</span> Query_ID <span class="token operator">|</span> Duration   <span class="token operator">|</span> Query                                                   <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+------------+---------------------------------------------------------+</span>
<span class="token operator">|</span>        <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">0.00017300</span> <span class="token operator">|</span> <span class="token keyword">select</span> @<span class="token variable">@profiling</span>                                      <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">0.00160700</span> <span class="token operator">|</span> <span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%profiling%'</span>                       <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">0.00044025</span> <span class="token operator">|</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>                                  <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token number">4</span> <span class="token operator">|</span> <span class="token number">0.00025700</span> <span class="token operator">|</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>                                  <span class="token operator">|</span>
<span class="token operator">|</span>        <span class="token number">5</span> <span class="token operator">|</span> <span class="token number">0.00025700</span> <span class="token operator">|</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> student<span class="token punctuation">;</span>                                  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+------------+---------------------------------------------------------+</span>
<span class="token number">4</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span><span class="token punctuation">,</span> <span class="token number">1</span> warning <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>


<span class="token comment">#查看语句执行计划（过程）select * from student;</span>
<span class="token keyword">show</span> profile cpu<span class="token punctuation">,</span>block io <span class="token keyword">for</span> query <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>对应逻辑架构的流程
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">Status</span>                         <span class="token operator">|</span> Duration <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000023</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking query cache <span class="token keyword">for</span> query <span class="token operator">|</span> <span class="token number">0.000028</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking permissions           <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">|</span> Opening <span class="token keyword">tables</span>                 <span class="token operator">|</span> <span class="token number">0.000013</span> <span class="token operator">|</span>
<span class="token operator">|</span> init                           <span class="token operator">|</span> <span class="token number">0.000012</span> <span class="token operator">|</span>
<span class="token operator">|</span> System <span class="token keyword">lock</span>                    <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> System <span class="token keyword">lock</span>                    <span class="token operator">|</span> <span class="token number">0.000013</span> <span class="token operator">|</span>
<span class="token operator">|</span> optimizing                     <span class="token operator">|</span> <span class="token number">0.000004</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">statistics</span>                     <span class="token operator">|</span> <span class="token number">0.000009</span> <span class="token operator">|</span>
<span class="token operator">|</span> preparing                      <span class="token operator">|</span> <span class="token number">0.000007</span> <span class="token operator">|</span>
<span class="token operator">|</span> executing                      <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> Sending <span class="token keyword">data</span>                   <span class="token operator">|</span> <span class="token number">0.000030</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">end</span>                            <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> query <span class="token keyword">end</span>                      <span class="token operator">|</span> <span class="token number">0.000033</span> <span class="token operator">|</span>
<span class="token operator">|</span> closing <span class="token keyword">tables</span>                 <span class="token operator">|</span> <span class="token number">0.000008</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000005</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000019</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000004</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> storing result <span class="token operator">in</span> query cache  <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> cleaning up                    <span class="token operator">|</span> <span class="token number">0.000009</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>

<span class="token comment">#第二次查询同一条sql，走缓存 select * from student;</span>
<span class="token keyword">show</span> profile cpu<span class="token punctuation">,</span>block io <span class="token keyword">for</span> query <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">Status</span>                         <span class="token operator">|</span> Duration <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000021</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking query cache <span class="token keyword">for</span> query <span class="token operator">|</span> <span class="token number">0.000005</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking <span class="token keyword">privileges</span> <span class="token keyword">on</span> cached  <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking permissions           <span class="token operator">|</span> <span class="token number">0.000009</span> <span class="token operator">|</span>
<span class="token operator">|</span> sending cached result <span class="token keyword">to</span> clien <span class="token operator">|</span> <span class="token number">0.000022</span> <span class="token operator">|</span>
<span class="token operator">|</span> cleaning up                    <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>

<span class="token comment">#只要sql不同，缓存就不会命中 SELECT * FROM student;</span>
<span class="token keyword">show</span> profile cpu<span class="token punctuation">,</span>block io <span class="token keyword">for</span> query <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">Status</span>                         <span class="token operator">|</span> Duration <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000019</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">starting</span>                       <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking query cache <span class="token keyword">for</span> query <span class="token operator">|</span> <span class="token number">0.000029</span> <span class="token operator">|</span>
<span class="token operator">|</span> checking permissions           <span class="token operator">|</span> <span class="token number">0.000007</span> <span class="token operator">|</span>
<span class="token operator">|</span> Opening <span class="token keyword">tables</span>                 <span class="token operator">|</span> <span class="token number">0.000031</span> <span class="token operator">|</span>
<span class="token operator">|</span> init                           <span class="token operator">|</span> <span class="token number">0.000014</span> <span class="token operator">|</span>
<span class="token operator">|</span> System <span class="token keyword">lock</span>                    <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> System <span class="token keyword">lock</span>                    <span class="token operator">|</span> <span class="token number">0.000011</span> <span class="token operator">|</span>
<span class="token operator">|</span> optimizing                     <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">statistics</span>                     <span class="token operator">|</span> <span class="token number">0.000008</span> <span class="token operator">|</span>
<span class="token operator">|</span> preparing                      <span class="token operator">|</span> <span class="token number">0.000007</span> <span class="token operator">|</span>
<span class="token operator">|</span> executing                      <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> Sending <span class="token keyword">data</span>                   <span class="token operator">|</span> <span class="token number">0.000032</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token keyword">end</span>                            <span class="token operator">|</span> <span class="token number">0.000003</span> <span class="token operator">|</span>
<span class="token operator">|</span> query <span class="token keyword">end</span>                      <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">|</span> closing <span class="token keyword">tables</span>                 <span class="token operator">|</span> <span class="token number">0.000005</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000004</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000006</span> <span class="token operator">|</span>
<span class="token operator">|</span> Waiting <span class="token keyword">for</span> query cache <span class="token keyword">lock</span>   <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> freeing items                  <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> storing result <span class="token operator">in</span> query cache  <span class="token operator">|</span> <span class="token number">0.000002</span> <span class="token operator">|</span>
<span class="token operator">|</span> cleaning up                    <span class="token operator">|</span> <span class="token number">0.000007</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">--------------------------------+----------+</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><p><strong>查看存储引擎</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">show</span> engines<span class="token punctuation">;</span>

<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">'%storage_engine%'</span><span class="token punctuation">;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-innodb"><a href="#_4-innodb" class="header-anchor">#</a> 4.InnoDB</h3> <blockquote><p>MySQL5.5开始默认使用InnoDB存储引擎</p></blockquote> <p><strong>特点</strong></p> <blockquote><p>行级锁
支持事务，适合处理大量短期事务
读写阻塞与事务隔离级别相关
可缓存数据和索引
支持聚簇索引
崩溃恢复性好
支持MVCC高并发
从MySQL5.5后支持全文索引
从MySQL5.5开始为默认的数据库引擎</p></blockquote> <p><strong>适用场景</strong></p> <blockquote><p>InnoDB是MySQL的默认事务型引擎，被设计用来处理大量的短期(short-lived)事务。可以确保事务的完整提交(Commit)和回滚(Rollback)。</p> <p>除了增加和查询外，还需要更新，删除操作，那么，应优选选择InnoDB存储引擎。</p> <p>除非有非常特别的原因需要使用其他的存储引擎，否则应该优先考虑InnoDB引擎。</p></blockquote> <p><strong>InnoDB引擎文件结构</strong></p> <blockquote><p>.frm 表格式定义，存放每个表自己的定义</p> <p>.ibd 数据文件，存储数据和索引</p> <p>ibdata1 位于上一级目录，所有表都集中在这里</p></blockquote> <h3 id="_5-myisam"><a href="#_5-myisam" class="header-anchor">#</a> 5.MyISAM</h3> <blockquote><p>MySQL5.5前默认使用MyISAM存储引擎</p></blockquote> <p><strong>特点</strong></p> <blockquote><p>不支持事务和行级锁
表级锁定
读写相互阻塞，写入不能读，读时不能写
只缓存索引
不支持外键索引
不支持聚簇索引
读取数据较快，占用资源较少
不支持MVCC（多版本并发控制机制）高并发
<strong>崩溃后无法安全恢复</strong>
MySQL5.5前默认的数据库引擎</p></blockquote> <p><strong>适用场景</strong></p> <blockquote><p>只读（或者写较少）、表较少（可以接受长时间进行修复操作）</p></blockquote> <p><strong>MyISAM引擎文件结构</strong></p> <blockquote><p>.frm 存储定义表</p> <p>.MYD 存储数据</p> <p>.MYI 存储索引</p></blockquote> <p><img src="/assets/img/image-20220106200928958.cfd4a225.png" alt="image-20220106200928958"></p> <blockquote><p>表格来源：https://docs.oracle.com/cd/E17952_01/mysql-5.5-en/storage-engines.html</p> <p>InnoDB、MyISAM部分参考：https://www.jianshu.com/p/cf4e34fb999f</p></blockquote> <h3 id="_6-其他存储引擎"><a href="#_6-其他存储引擎" class="header-anchor">#</a> 6.其他存储引擎</h3> <p><strong>Archive</strong></p> <blockquote><p>Archive档案存储引擎只支持<strong>INSERT</strong>和<strong>SELECT</strong>操作，在MySQL5.1之前不支持索引。</p> <p>Archive表**适合日志和数据采集（档案）**类应用。</p> <p>根据英文的测试结论来看，Archive表比MyISAM表要小大约75%，比支持事务处理的InnoDB表小大约83%。</p></blockquote> <p><strong>Blackhole</strong></p> <blockquote><p>Blackhole引擎没有实现任何存储机制，它会丢弃所有插入的数据，不做任何保存。</p> <p>但服务器会记录Blackhole表的日志，所以可以用于复制数据到备库，或者简单地记录到日志。但这种应用方式会碰到很多问题，因此并不推荐。</p> <p>???</p></blockquote> <p><strong>CSV</strong></p> <blockquote><p>CSV引擎可以将普通的CSV文件作为MySQL的表来处理，但不支持索引。</p> <p>CSV引擎可以作为一种数据交换的机制，非常有用。</p> <p>CSV存储的数据直接可以在操作系统里，用文本编辑器，或者excel读取。</p></blockquote> <p><strong>Memory</strong></p> <blockquote><p>如果需要快速地访问数据，并且这些数据不会被修改，重启以后丢失也没有关系，那么使用Memory表是非常有用。</p> <p>Memory表至少比MyISAM表要快一个数量级。</p></blockquote> <p><strong>Federated</strong></p> <blockquote><p>Federated引擎是访问其他MySQL服务器的一个代理，尽管该引擎看起来提供了一种很好的跨服务器的灵活性，但也经常带来问题，因此默认是禁用的。</p></blockquote> <p><strong>Percona</strong>*</p> <blockquote><p><strong>Percona</strong> 为 MySQL 数据库服务器进行了改进，在功能和性能上较 MySQL 有很显著的提升。该版本提升了在高负载情况下的 InnoDB 的性能、为 DBA 提供一些非常有用的性能诊断工具；另外有更多的参数和命令来控制服务器行为。 存储引擎为Xtradb，完全替代Innodb,并且在性能和并发上做得更好。</p> <p>阿里大部分mysql数据库使用的是percona的原型加以修改。AliSql+AliRedis</p></blockquote> <h2 id="sql执行顺序"><a href="#sql执行顺序" class="header-anchor">#</a> SQL执行顺序</h2> <h3 id="_1-完整sql执行流程"><a href="#_1-完整sql执行流程" class="header-anchor">#</a> 1.完整sql执行流程</h3> <p><img src="/assets/img/image-20220106224326481.db776873.png" alt="image-20220106224326481"></p> <p><strong>笛卡尔积</strong></p> <blockquote><p>https://zh.wikipedia.org/wiki/%E7%AC%9B%E5%8D%A1%E5%84%BF%E7%A7%AF</p> <p>数据库中就表示多表组合的所有情况</p></blockquote> <p><strong>比如一个较完整的多表连接查询语句</strong></p> <p>第一步</p> <blockquote><p>首先对from子句中的前两个表执行一个笛卡尔乘积，生成虚拟表 <strong>vt1</strong>（选择相对小的表做基础表）</p></blockquote> <p>第二步</p> <blockquote><p>接下来应用on筛选器，on中的逻辑表达式将应用到 vt1 中的各个行，筛选出满足on逻辑表达式的行，生成虚拟表 <strong>vt2</strong></p></blockquote> <p>第三步</p> <blockquote><p>如果是outer join 那么这一步就将添加外部行，left outer jion 就把左表在第二步中过滤的添加进来，如果是right outer join 那么就将右表在第二步中过滤掉的行添加进来，这样生成虚拟表 <strong>vt3</strong></p> <p>？？？</p></blockquote> <p>第四步</p> <blockquote><p>如果 from 子句中的表数目多余两个表，那么就将vt3和第三个表连接从而计算笛卡尔乘积，生成虚拟表，该过程就是一个重复1-3的步骤，最终得到一个新的虚拟表 vt3</p></blockquote> <p>第五步</p> <blockquote><p>应用where筛选器，对上一步生产的虚拟表引用where筛选器，过滤条件，生成虚拟表<strong>vt4</strong></p></blockquote> <p><strong>注意</strong></p> <blockquote><p>注意:对于包含outer join子句的查询，到底在on筛选器还是用where筛选器指定逻辑表达式呢？
on和where的最大区别在于，如果在on应用逻辑表达式那么在第三步outer join中还可以把移除的行再次添加回来，而where的移除的最终的。
举个简单的例子:
有一个学生表（班级,姓名）和一个成绩表(姓名,成绩)，我现在需要返回一个x班级的全体同学的成绩，但是这个班级有几个学生缺考，也就是说在成绩表中没有记录。
为了得到我们预期的结果我们就需要在on子句指定学生和成绩表的关系（学生.姓名=成绩.姓名）
那么我们是否发现在执行第二步的时候，对于没有参加考试的学生记录就不会出现在vt2中，因为他们被on的逻辑表达式过滤掉了
但是我们用left outer join就可以把左表（学生）中没有参加考试的学生找回来，因为我们想返回的是x班级的所有学生
如果在on中应用学生.班级='x'的话，left outer join会把x班级的所有学生记录找回
所以只能在where筛选器中应用学生.班级='x' 因为它的过滤是最终的。
总结: 最终过滤条件放在where语句中,on语句做数据匹配不要做筛选!!!</p></blockquote> <p>第六步</p> <blockquote><p>group by 子句将中的唯一的值组合成为一组，得到虚拟表<strong>vt5</strong>。如果应用了group by，那么后面的所有步骤都只能得到的vt5的列或者是聚合函数（count、sum、avg等）。<strong>原因在于最终的结果集中只为每个组包含一行,这一点请牢记。</strong></p> <p>注意：一般group by和聚合函数一起使用，例如<strong>group_concat()</strong></p></blockquote> <p>第七步</p> <blockquote><p>应用cube或者rollup选项，为vt5生成超组，生成<strong>vt6</strong></p></blockquote> <p>第八步</p> <blockquote><p>应用having筛选器，生成<strong>vt7</strong>。having筛选器是第一个也是为唯一一个应用到已分组数据的筛选器</p></blockquote> <p>第九步</p> <blockquote><p>处理select子句。将vt7中的在select中出现的列筛选出来。生成<strong>vt8</strong></p></blockquote> <p>第十步</p> <blockquote><p>应用distinct子句，vt8中移除相同的行，生成<strong>vt9</strong></p></blockquote> <p>第十一步</p> <blockquote><p>应用order by子句。按照order_by_condition排序vt9，此时返回的一个游标，而不是虚拟表</p></blockquote> <p><strong>游标</strong></p> <blockquote><p>sql是基于集合的理论的，集合不会预先对他的行排序，它只是成员的逻辑集合，成员的顺序是无关紧要的。对表进行排序的查询可以返回一个对象，这个对象包含特定的物理顺序的逻辑组织。这个对象就叫游标。正因为返回值是游标，那么使用order by 子句查询不能应用于表表达式。排序是很需要成本的，除非你必须要排序，否则最好不要指定order by，最后，在这一步中是第一个也是唯一一个可以使用select列表中别名的步骤。</p></blockquote> <p>第十二步</p> <blockquote><p>返回结果给请求者</p></blockquote> <h3 id="_2-再探join"><a href="#_2-再探join" class="header-anchor">#</a> 2.再探join</h3></div></div> <div class="page-slot page-slot-bottom">
  <div class="wwads-cn wwads-horizontal pageB" data-id="136" style="width:100%;max-height:80px;min-height:auto;"></div>
  <style>
    .pageB img{width:80px!important;}
    .wwads-horizontal .wwads-text, .wwads-content .wwads-text{line-height:1;}
  </style>
  </div> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/fd06c0/" class="prev">MySQL基础</a></span> <span class="next"><a href="/pages/454bc7/">索引失效</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="/" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/vikicoco" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/discover/playlist" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>viki | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <div class="custom-html-window custom-html-window-rb" style="display:;"><div class="custom-wrapper"><span class="close-but">×</span> <div>
    <div class="wwads-cn wwads-vertical windowRB" data-id="136" style="max-width:160px;
    min-width: auto;min-height:auto;"></div>
    <style>
      .windowRB{ padding: 0;}
      .windowRB .wwads-img{margin-top: 10px;}
      .windowRB .wwads-content{margin: 0 10px 10px 10px;}
      .custom-html-window-rb .close-but{
        display: none;
      }
    </style>
  </div></div></div></div><div class="global-ui"><APlayer audio="" fixed="true" theme="#b7daff" loop="loop" order="random" preload="auto" volume="0.2" mutex="true" lrc-type="0" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer></div></div>
    <script src="/assets/js/app.9f1ace71.js" defer></script><script src="/assets/js/2.acae172f.js" defer></script><script src="/assets/js/3.71c56e22.js" defer></script><script src="/assets/js/5.70e5e3ae.js" defer></script>
  </body>
</html>
